<!doctype html><html><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><title>
        Webgraph from scratch (Draft)
    </title><link href=/corro.svg rel=icon type=image/png><link href=https://zom.wtf/fonts.css rel=stylesheet><link href=/path/to/folder/css/academicons.min.css rel=stylesheet><link href=https://zom.wtf/atom.xml rel=alternate title=zom.wtf type=application/atom+xml><link href=https://zom.wtf/theme/light.css rel=stylesheet><link href=https://zom.wtf/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><img id=title_icon src=/corro.svg><a href=https://zom.wtf>zom.wtf</a><div class=socials><a class=social href=https://twitter.com/zommiommy> <img alt=twitter src=/social_icons/twitter.svg> </a><a class=social href=https://github.com/zommiommy> <img alt=github src=/social_icons/github.svg> </a></div></div><nav><a href=/posts style=margin-left:.7em>/posts</a><a href=/about style=margin-left:.7em>/about</a><a href=/goodstuff style=margin-left:.7em>/good_stuff</a></nav></header><main><article><div class=title><div class=page-header>Webgraph from scratch (Draft)</div><div class=meta>Posted on <time>2023-04-19</time></div></div><h1>Table of Contents</h1><ul><li><a href=https://zom.wtf/posts/webgaph/#introduction>Introduction</a><li><a href=https://zom.wtf/posts/webgaph/#theoretical-preliminaries>Theoretical preliminaries</a> <ul><li><a href=https://zom.wtf/posts/webgaph/#entropy>Entropy</a><li><a href=https://zom.wtf/posts/webgaph/#intended-distributions>Intended Distributions</a><li><a href=https://zom.wtf/posts/webgaph/#prefix-code>Prefix code</a><li><a href=https://zom.wtf/posts/webgaph/#universal-code>Universal code</a></ul><li><a href=https://zom.wtf/posts/webgaph/#codes>Codes</a> <ul><li><a href=https://zom.wtf/posts/webgaph/#fixed-length>Fixed length</a><li><a href=https://zom.wtf/posts/webgaph/#unary>Unary</a><li><a href=https://zom.wtf/posts/webgaph/#elias-gamma>Elias-Gamma</a><li><a href=https://zom.wtf/posts/webgaph/#elias-delta>Elias-Delta</a><li><a href=https://zom.wtf/posts/webgaph/#truncated-binary-encoding>Truncated Binary Encoding</a><li><a href=https://zom.wtf/posts/webgaph/#zeta>Zeta</a></ul><li><a href=https://zom.wtf/posts/webgaph/#encoding-of-negative-numbers>Encoding of negative numbers</a><li><a href=https://zom.wtf/posts/webgaph/#webgraph>Webgraph</a> <ul><li><a href=https://zom.wtf/posts/webgaph/#example>Example</a></ul><li><a href=https://zom.wtf/posts/webgaph/#benchmarks>Benchmarks</a><li><a href=https://zom.wtf/posts/webgaph/#references>References</a></ul><section class=body><h1 id=introduction>Introduction</h1><h1 id=theoretical-preliminaries>Theoretical preliminaries</h1><p>All bit sequences will be read from left to right, from top to bottom. For ease of reading I will be using the convention that <strong>all codes start from 0</strong> by adding a +1 where needed. This differs from the <strong>book definitions</strong> of the codes, but it's how you practically implement them.<h2 id=entropy><a href=https://en.wikipedia.org/wiki/Entropy_(information_theory)>Entropy</a></h2><h2 id=intended-distributions>Intended Distributions</h2><h2 id=prefix-code><a href=https://en.wikipedia.org/wiki/Prefix_code>Prefix code</a></h2><h2 id=universal-code><a href=https://en.wikipedia.org/wiki/Universal_code_(data_compression)>Universal code</a></h2><h1 id=codes>Codes</h1><h3 id=fixed-length>Fixed length</h3><p>Optimal for uniform distributions of values in \(\left[0, 2^\text{n_bits}\right)\):<pre class=language-python data-lang=python style=background:#0f1419;color:#bfbab0><code class=language-python data-lang=python><span style=color:#ff7733>def </span><span style=color:#ffb454>write_fixed_length</span><span>(</span><span style=color:#f29718>value</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>n_bits</span><span>):
</span><span>    </span><span style=color:#ff7733>return </span><span>(</span><span style=color:#c2d94c>"</span><span style=color:#f29718>{:0%sb}</span><span style=color:#c2d94c>"</span><span style=color:#f29668>%</span><span>n_bits)</span><span style=color:#f29668>.</span><span style=color:#ffb454>format</span><span>(value)
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>read_fixed_length</span><span>(</span><span style=color:#f29718>data</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>n_bits</span><span>):
</span><span>    </span><span style=color:#ff7733>return </span><span style=font-style:italic;color:#39bae6>int</span><span>(data[</span><span style=color:#bfbab0cc>:</span><span>n_bits]</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>2</span><span>), data[n_bits</span><span style=color:#bfbab0cc>:</span><span>]
</span></code></pre><h3 id=unary>Unary</h3><p>Optimal for geometric distributions with \(p = \frac{1}{2}\), i.e. \(P(x) = \left(\frac{1}{2}\right)^{x + 1}\):<table><thead><tr><th>Number<th>Code<tbody><tr><td>0<td>1<tr><td>1<td>01<tr><td>2<td>001<tr><td>3<td>0001<tr><td>4<td>00001<tr><td>5<td>000001<tr><td>6<td>0000001<tr><td>7<td>00000001<tr><td>8<td>000000001</table><pre class=language-python data-lang=python style=background:#0f1419;color:#bfbab0><code class=language-python data-lang=python><span style=color:#ff7733>def </span><span style=color:#ffb454>write_unary</span><span>(</span><span style=color:#f29718>value</span><span>):
</span><span>    </span><span style=color:#ff7733>return </span><span style=color:#c2d94c>"0" </span><span style=color:#f29668>* </span><span>value </span><span style=color:#f29668>+ </span><span style=color:#c2d94c>"1"
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>len_unary</span><span>(</span><span style=color:#f29718>value</span><span>):
</span><span>    </span><span style=color:#ff7733>return </span><span>value </span><span style=color:#f29668>+ </span><span style=color:#f29718>1
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>read_unary</span><span>(</span><span style=color:#f29718>data</span><span>):
</span><span>    res </span><span style=color:#f29668>= </span><span style=color:#f07178>len</span><span>(data</span><span style=color:#f29668>.</span><span style=color:#ffb454>ltim</span><span>(</span><span style=color:#c2d94c>"0"</span><span>)) </span><span style=color:#f29668>- </span><span style=color:#f07178>len</span><span>(data)
</span><span>    </span><span style=color:#ff7733>return </span><span>res, data[res </span><span style=color:#f29668>+ </span><span style=color:#f29718>1</span><span style=color:#bfbab0cc>:</span><span>]
</span></code></pre><h3 id=elias-gamma><a href=https://en.wikipedia.org/wiki/Elias_gamma_coding#Further_reading>Elias-Gamma</a></h3><table><thead><tr><th>Number<th>Code<tbody><tr><td>0<td>1<tr><td>1<td>01 0<tr><td>2<td>01 1<tr><td>3<td>001 00<tr><td>4<td>001 01<tr><td>5<td>001 10<tr><td>6<td>001 11<tr><td>7<td>0001 000<tr><td>8<td>0001 001</table><pre class=language-python data-lang=python style=background:#0f1419;color:#bfbab0><code class=language-python data-lang=python><span style=color:#ff7733>from </span><span>math </span><span style=color:#ff7733>import </span><span>floor</span><span style=color:#bfbab0cc>, </span><span>ceil</span><span style=color:#bfbab0cc>, </span><span>log2
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>write_gamma</span><span>(</span><span style=color:#f29718>value</span><span>):
</span><span>    value </span><span style=color:#f29668>+= </span><span style=color:#f29718>1
</span><span>    l </span><span style=color:#f29668>= </span><span style=color:#ffb454>floor</span><span>(</span><span style=color:#ffb454>log2</span><span>(value))
</span><span>    s </span><span style=color:#f29668>= </span><span>value </span><span style=color:#f29668>- </span><span>(</span><span style=color:#f29718>1 </span><span style=color:#f29668><< </span><span>l)
</span><span>    data </span><span style=color:#f29668>= </span><span style=color:#ffb454>write_unary</span><span>(l</span><span style=color:#bfbab0cc>, </span><span>bitstream</span><span style=color:#bfbab0cc>, </span><span>m2l)
</span><span>    </span><span style=color:#ff7733>if </span><span>l </span><span style=color:#f29668>!= </span><span style=color:#f29718>0</span><span>:
</span><span>        data </span><span style=color:#f29668>+= </span><span style=color:#ffb454>write_fixed_length</span><span>(s</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>n_bits</span><span style=color:#f29668>=</span><span>l)
</span><span>    </span><span style=color:#ff7733>return </span><span>v
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>len_gamma</span><span>(</span><span style=color:#f29718>value</span><span>):
</span><span>    </span><span style=color:#ff7733>return </span><span style=color:#f29718>2</span><span style=color:#f29668>*</span><span style=color:#ffb454>floor</span><span>(</span><span style=color:#ffb454>log2</span><span>(value </span><span style=color:#f29668>+ </span><span style=color:#f29718>1</span><span>)) </span><span style=color:#f29668>+ </span><span style=color:#f29718>1
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>read_gamma</span><span>(</span><span style=color:#f29718>data</span><span>):
</span><span>    l, data </span><span style=color:#f29668>= </span><span style=color:#ffb454>read_unary</span><span>(data)
</span><span>    </span><span style=color:#ff7733>if </span><span>l </span><span style=color:#f29668>== </span><span style=color:#f29718>0</span><span>:
</span><span>        </span><span style=color:#ff7733>return </span><span style=color:#f29718>0</span><span>, data
</span><span>    f, data </span><span style=color:#f29668>= </span><span style=color:#ffb454>read_fixed_length</span><span>(data</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>n_bits</span><span style=color:#f29668>=</span><span>l)
</span><span>    v </span><span style=color:#f29668>= </span><span>f </span><span style=color:#f29668>+ </span><span>(</span><span style=color:#f29718>1 </span><span style=color:#f29668><< </span><span>l) </span><span style=color:#f29668>- </span><span style=color:#f29718>1
</span><span>    </span><span style=color:#ff7733>return </span><span>v, data
</span></code></pre><h3 id=elias-delta><a href=https://en.wikipedia.org/wiki/Elias_delta_coding>Elias-Delta</a></h3><table><thead><tr><th>Number<th>Code<tbody><tr><td>0<td>1<tr><td>1<td>01 0 0<tr><td>2<td>01 1 1<tr><td>3<td>01 10 0<tr><td>4<td>01 10 1<tr><td>5<td>01 11 0<tr><td>6<td>01 11 1<tr><td>7<td>0001 00 000<tr><td>8<td>0001 00 001</table><pre class=language-python data-lang=python style=background:#0f1419;color:#bfbab0><code class=language-python data-lang=python><span style=color:#ff7733>from </span><span>math </span><span style=color:#ff7733>import </span><span>floor</span><span style=color:#bfbab0cc>, </span><span>ceil</span><span style=color:#bfbab0cc>, </span><span>log2
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>write_delta</span><span>(</span><span style=color:#f29718>value</span><span>):
</span><span>    value </span><span style=color:#f29668>+= </span><span style=color:#f29718>1
</span><span>    l </span><span style=color:#f29668>= </span><span style=color:#ffb454>floor</span><span>(</span><span style=color:#ffb454>log2</span><span>(value))
</span><span>    s </span><span style=color:#f29668>= </span><span>value </span><span style=color:#f29668>- </span><span>(</span><span style=color:#f29718>1 </span><span style=color:#f29668><< </span><span>l)
</span><span>    data </span><span style=color:#f29668>= </span><span style=color:#ffb454>write_gamma</span><span>(l</span><span style=color:#bfbab0cc>, </span><span>bitstream</span><span style=color:#bfbab0cc>, </span><span>m2l)
</span><span>    </span><span style=color:#ff7733>if </span><span>l </span><span style=color:#f29668>!= </span><span style=color:#f29718>0</span><span>:
</span><span>        data </span><span style=color:#f29668>+= </span><span style=color:#ffb454>write_fixed_length</span><span>(s</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>n_bits</span><span style=color:#f29668>=</span><span>l)
</span><span>    </span><span style=color:#ff7733>return </span><span>data
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>len_delta</span><span>(</span><span style=color:#f29718>value</span><span>):
</span><span>    l </span><span style=color:#f29668>= </span><span style=color:#ffb454>floor</span><span>(</span><span style=color:#ffb454>log2</span><span>(value </span><span style=color:#f29668>+ </span><span style=color:#f29718>1</span><span>))
</span><span>    </span><span style=color:#ff7733>return </span><span>l </span><span style=color:#f29668>+ </span><span style=color:#f29718>2</span><span style=color:#f29668>*</span><span style=color:#ffb454>floor</span><span>(</span><span style=color:#ffb454>log2</span><span>(l </span><span style=color:#f29668>+ </span><span style=color:#f29718>1</span><span>)) </span><span style=color:#f29668>+ </span><span style=color:#f29718>1
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>read_delta</span><span>(</span><span style=color:#f29718>data</span><span>):
</span><span>    l, data </span><span style=color:#f29668>= </span><span style=color:#ffb454>read_gamma</span><span>(data)
</span><span>    </span><span style=color:#ff7733>if </span><span>l </span><span style=color:#f29668>== </span><span style=color:#f29718>0</span><span>:
</span><span>        </span><span style=color:#ff7733>return </span><span style=color:#f29718>0</span><span>, data
</span><span>    f, data </span><span style=color:#f29668>= </span><span style=color:#ffb454>read_fixed_length</span><span>(data</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>n_bits</span><span style=color:#f29668>=</span><span>l)
</span><span>    v </span><span style=color:#f29668>= </span><span>f </span><span style=color:#f29668>+ </span><span>(</span><span style=color:#f29718>1 </span><span style=color:#f29668><< </span><span>l) </span><span style=color:#f29668>- </span><span style=color:#f29718>1
</span><span>    </span><span style=color:#ff7733>return </span><span>v, data
</span></code></pre><h3 id=truncated-binary-encoding><a href=https://en.wikipedia.org/wiki/Truncated_binary_encoding>Truncated Binary Encoding</a></h3><pre class=language-python data-lang=python style=background:#0f1419;color:#bfbab0><code class=language-python data-lang=python><span style=color:#ff7733>from </span><span>math </span><span style=color:#ff7733>import </span><span>floor</span><span style=color:#bfbab0cc>, </span><span>ceil</span><span style=color:#bfbab0cc>, </span><span>log2
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>write_minimal_binary</span><span>(</span><span style=color:#f29718>value</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>max</span><span>):
</span><span>    l </span><span style=color:#f29668>= </span><span style=font-style:italic;color:#39bae6>int</span><span>(</span><span style=color:#ffb454>floor</span><span>(</span><span style=color:#ffb454>log2</span><span>(</span><span style=color:#f07178>max</span><span>))) 
</span><span>    limit </span><span style=color:#f29668>= </span><span>(</span><span style=color:#f29718>1 </span><span style=color:#f29668><< </span><span>(l </span><span style=color:#f29668>+ </span><span style=color:#f29718>1</span><span>)) </span><span style=color:#f29668>- </span><span style=color:#f07178>max
</span><span>
</span><span>    </span><span style=color:#ff7733>if </span><span>value </span><span style=color:#f29668>< </span><span>limit:
</span><span>        data </span><span style=color:#f29668>= </span><span style=color:#ffb454>write_fixed_length</span><span>(value</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>n_bits</span><span style=color:#f29668>=</span><span>l)
</span><span>    </span><span style=color:#ff7733>else</span><span>:
</span><span>        to_write </span><span style=color:#f29668>= </span><span>value </span><span style=color:#f29668>+ </span><span>limit
</span><span>        data  </span><span style=color:#f29668>= </span><span style=color:#ffb454>write_fixed_length</span><span>(to_write </span><span style=color:#f29668>>> </span><span style=color:#f29718>1</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>n_bits</span><span style=color:#f29668>=</span><span>l)
</span><span>        data </span><span style=color:#f29668>+= </span><span style=color:#ffb454>write_fixed_length</span><span>(to_write </span><span style=color:#f29668>& </span><span style=color:#f29718>1</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>n_bits</span><span style=color:#f29668>=</span><span style=color:#f29718>1</span><span>)
</span><span>    </span><span style=color:#ff7733>return </span><span>data
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>len_minimal_binary</span><span>(</span><span style=color:#f29718>value</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>max</span><span>):
</span><span>    l </span><span style=color:#f29668>= </span><span style=font-style:italic;color:#39bae6>int</span><span>(</span><span style=color:#ffb454>floor</span><span>(</span><span style=color:#ffb454>log2</span><span>(</span><span style=color:#f07178>max</span><span>)))
</span><span>    limit </span><span style=color:#f29668>= </span><span>(</span><span style=color:#f29718>1 </span><span style=color:#f29668><< </span><span>(l </span><span style=color:#f29668>+ </span><span style=color:#f29718>1</span><span>)) </span><span style=color:#f29668>- </span><span style=color:#f07178>max
</span><span>    </span><span style=color:#ff7733>if </span><span>value </span><span style=color:#f29668>>= </span><span>limit:
</span><span>        </span><span style=color:#ff7733>return </span><span>l </span><span style=color:#f29668>+ </span><span style=color:#f29718>1
</span><span>    </span><span style=color:#ff7733>else</span><span>:
</span><span>        </span><span style=color:#ff7733>return </span><span>l
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>read_minimal_binary</span><span>(</span><span style=color:#f29718>data</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>max</span><span>):
</span><span>    l </span><span style=color:#f29668>= </span><span style=font-style:italic;color:#39bae6>int</span><span>(</span><span style=color:#ffb454>floor</span><span>(</span><span style=color:#ffb454>log2</span><span>(</span><span style=color:#f07178>max</span><span>)))
</span><span>    v, data </span><span style=color:#f29668>= </span><span style=color:#ffb454>read_fixed_length</span><span>(data</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>n_bits</span><span style=color:#f29668>=</span><span>l)
</span><span>    limit </span><span style=color:#f29668>= </span><span>(</span><span style=color:#f29718>1 </span><span style=color:#f29668><< </span><span>(l </span><span style=color:#f29668>+ </span><span style=color:#f29718>1</span><span>)) </span><span style=color:#f29668>- </span><span style=color:#f07178>max
</span><span>
</span><span>    </span><span style=color:#ff7733>if </span><span>v </span><span style=color:#f29668>< </span><span>limit:
</span><span>        </span><span style=color:#ff7733>return </span><span>v, data
</span><span>    </span><span style=color:#ff7733>else</span><span>:
</span><span>        b, data </span><span style=color:#f29668>= </span><span style=color:#ffb454>read_fixed_length</span><span>(data</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>n_bits</span><span style=color:#f29668>=</span><span style=color:#f29718>1</span><span>)
</span><span>        v </span><span style=color:#f29668>= </span><span>(v </span><span style=color:#f29668><< </span><span style=color:#f29718>1</span><span>) </span><span style=color:#f29668>| </span><span>b
</span><span>        </span><span style=color:#ff7733>return </span><span>v </span><span style=color:#f29668>- </span><span>limit, data
</span></code></pre><h3 id=zeta><a href=https://vigna.di.unimi.it/ftp/papers/Codes.pdf>Zeta</a></h3><pre class=language-python data-lang=python style=background:#0f1419;color:#bfbab0><code class=language-python data-lang=python><span style=color:#ff7733>from </span><span>math </span><span style=color:#ff7733>import </span><span>floor</span><span style=color:#bfbab0cc>, </span><span>ceil</span><span style=color:#bfbab0cc>, </span><span>log2
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>write_zeta</span><span>(</span><span style=color:#f29718>value</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>k</span><span>):
</span><span>    value </span><span style=color:#f29668>+= </span><span style=color:#f29718>1
</span><span>    h </span><span style=color:#f29668>= </span><span style=font-style:italic;color:#39bae6>int</span><span>(</span><span style=color:#ffb454>floor</span><span>(</span><span style=color:#ffb454>log2</span><span>(value)) </span><span style=color:#f29668>/ </span><span>k)
</span><span>    u </span><span style=color:#f29668>= </span><span style=color:#f29718>2</span><span style=color:#f29668>**</span><span>((h </span><span style=color:#f29668>+ </span><span style=color:#f29718>1</span><span>) </span><span style=color:#f29668>* </span><span>k)
</span><span>    l </span><span style=color:#f29668>= </span><span style=color:#f29718>2</span><span style=color:#f29668>**</span><span>(h </span><span style=color:#f29668>* </span><span>k)
</span><span>
</span><span>    data  </span><span style=color:#f29668>= </span><span style=color:#ffb454>write_unary</span><span>(h)
</span><span>    data </span><span style=color:#f29668>+= </span><span style=color:#ffb454>write_minimal_binary</span><span>(value </span><span style=color:#f29668>- </span><span>l</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>max</span><span style=color:#f29668>=</span><span>u </span><span style=color:#f29668>- </span><span>l)
</span><span>    </span><span style=color:#ff7733>return </span><span>data
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>len_zeta</span><span>(</span><span style=color:#f29718>value</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>k</span><span>):
</span><span>    value </span><span style=color:#f29668>+= </span><span style=color:#f29718>1
</span><span>    h </span><span style=color:#f29668>= </span><span style=font-style:italic;color:#39bae6>int</span><span>(</span><span style=color:#ffb454>floor</span><span>(</span><span style=color:#ffb454>log2</span><span>(value)) </span><span style=color:#f29668>/ </span><span>k)
</span><span>    u </span><span style=color:#f29668>= </span><span style=color:#f29718>2</span><span style=color:#f29668>**</span><span>((h </span><span style=color:#f29668>+ </span><span style=color:#f29718>1</span><span>) </span><span style=color:#f29668>* </span><span>k)
</span><span>    l </span><span style=color:#f29668>= </span><span style=color:#f29718>2</span><span style=color:#f29668>**</span><span>(h </span><span style=color:#f29668>* </span><span>k)
</span><span>    </span><span style=color:#ff7733>return </span><span style=color:#ffb454>len_unary</span><span>(h) </span><span style=color:#f29668>+ </span><span style=color:#ffb454>len_minimal_binary</span><span>(value </span><span style=color:#f29668>- </span><span>l</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>max</span><span style=color:#f29668>=</span><span>u </span><span style=color:#f29668>- </span><span>l)
</span><span>
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>read_zeta</span><span>(</span><span style=color:#f29718>data</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>k</span><span>):
</span><span>    h, data </span><span style=color:#f29668>= </span><span style=color:#ffb454>read_unary</span><span>(data)
</span><span>    u </span><span style=color:#f29668>= </span><span style=color:#f29718>2</span><span style=color:#f29668>**</span><span>((h </span><span style=color:#f29668>+ </span><span style=color:#f29718>1</span><span>) </span><span style=color:#f29668>* </span><span>k)
</span><span>    l </span><span style=color:#f29668>= </span><span style=color:#f29718>2</span><span style=color:#f29668>**</span><span>(h </span><span style=color:#f29668>* </span><span>k)
</span><span>    r, data </span><span style=color:#f29668>= </span><span style=color:#ffb454>read_minimal_binary</span><span>(data</span><span style=color:#bfbab0cc>, </span><span style=color:#f29718>max</span><span style=color:#f29668>=</span><span>u </span><span style=color:#f29668>- </span><span>l)
</span><span>    </span><span style=color:#ff7733>return </span><span>l </span><span style=color:#f29668>+ </span><span>r </span><span style=color:#f29668>- </span><span style=color:#f29718>1</span><span>, data
</span></code></pre><h1 id=encoding-of-negative-numbers>Encoding of negative numbers</h1><pre class=language-python data-lang=python style=background:#0f1419;color:#bfbab0><code class=language-python data-lang=python><span style=color:#ff7733>def </span><span style=color:#ffb454>nat2int</span><span>(</span><span style=color:#f29718>x</span><span>):
</span><span>    </span><span style=color:#ff7733>return </span><span>(x </span><span style=color:#f29668>>> </span><span style=color:#f29718>1</span><span>) </span><span style=color:#f29668>^ ~</span><span>((x </span><span style=color:#f29668>& </span><span style=color:#f29718>1</span><span>) </span><span style=color:#f29668>- </span><span style=color:#f29718>1</span><span>)
</span><span>
</span><span style=color:#ff7733>def </span><span style=color:#ffb454>int2nat</span><span>(</span><span style=color:#f29718>x</span><span>):
</span><span>    </span><span style=color:#ff7733>if </span><span>x </span><span style=color:#f29668>> </span><span style=color:#f29718>0</span><span>:
</span><span>        </span><span style=color:#ff7733>return </span><span>x </span><span style=color:#f29668><< </span><span style=color:#f29718>1
</span><span>    </span><span style=color:#ff7733>else</span><span>:
</span><span>        </span><span style=color:#ff7733>return </span><span>(x </span><span style=color:#f29668><< </span><span style=color:#f29718>1</span><span>) </span><span style=color:#f29668>| </span><span style=color:#f29718>1
</span></code></pre><h1 id=webgraph>Webgraph</h1><h2 id=example>Example</h2><p><img alt src=/webgraph_graph.svg> Let's start by computing the neighbours of each node:<pre style=background:#0f1419;color:#bfbab0><code><span>0: 1,2
</span><span>1: 3
</span><span>2: 3
</span><span>3: 4,5,6
</span><span>4: 5,6,8
</span><span>5: 7
</span><span>6: 7
</span><span>7:
</span><span>8:
</span></code></pre><p>The bits properly identified<div><span class="tag tag_degree">011</span><span class="tag tag_reference_offset">1</span><span class="tag tag_nintervals">1</span><span class="tag tag_first_residual">1010</span><span class="tag tag_residual_gap">1010</span></div> Reading the codes we obtain: <div><span class="tag tag_degree">3</span><span class="tag tag_reference_offset">0</span><span class="tag tag_nintervals">0</span><span class="tag tag_first_residual">2</span><span class="tag tag_residual_gap">2</span></div> And after applying all the needed +1, -1 and nat -> signed converstions, we have: <div><span class="tag tag_degree">2</span><span class="tag tag_reference_offset">0</span><span class="tag tag_nintervals">0</span><span class="tag tag_first_residual">1</span><span class="tag tag_residual_gap">2</span></div><table><thead><tr><th>Value<th>Code<tbody><tr><td class="tag tag_degree">Outdegree<td>Gamma<tr><td class="tag tag_reference_offset">ReferenceOffset<td>Unary<tr><td class="tag tag_blocks_count">BlockCount<td>Gamma<tr><td class="tag tag_blocks">Blocks<td>Gamma<tr><td class="tag tag_nintervals">IntervalCount<td>Gamma<tr><td class="tag tag_interval_start">IntervalStart<td>Gamma<tr><td class="tag tag_interval_len">IntervalLen<td>Gamma<tr><td class="tag tag_first_residual">FirstResidual<td>Zeta(3)<tr><td class="tag tag_residual_gap">ResidualGap<td>Zeta(3)</table><h1 id=benchmarks>Benchmarks</h1><h1 id=references>References</h1><ul><li>[https://vigna.di.unimi.it/algoweb/WebGraph.pdf]<li>[https://webgraph.di.unimi.it/]<li>[https://vigna.di.unimi.it/ftp/papers/Codes.pdf]<li>[https://www.ics.uci.edu/~djp3/classes/2008_01_01_INF141/Materials/p595-boldi.pdf]<li>[https://github.com/vigna/webgraph]<li>[https://github.com/vigna/webgraph-rs]<li>[https://boldi.di.unimi.it/Corsi/AlgorithmsForLargeGraphs/lesson1.pdf]<li>[https://boldi.di.unimi.it/Corsi/AlgorithmsForLargeGraphs/lesson2.pdf]<li>[https://boldi.di.unimi.it/Corsi/AlgorithmsForLargeGraphs/lesson3-1.pdf]<li>[https://boldi.di.unimi.it/Corsi/AlgorithmsForLargeGraphs/lesson3-2.pdf]<li>[https://boldi.di.unimi.it/Corsi/AlgorithmsForLargeGraphs/lesson4-1.pdf]<li>[https://boldi.di.unimi.it/Corsi/AlgorithmsForLargeGraphs/lesson4-2.pdf]</ul></section></article></main></div><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script async id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script>